
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Section 11: Install "Kubernetes the kubeadm way" Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Troubleshooting.md" />
    
    
    <link rel="prev" href="Install.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Scheduling.html">
            
                <a href="Scheduling.html">
            
                    
                    Section 1-3: Scheduling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Logging.html">
            
                <a href="Logging.html">
            
                    
                    Section 4: Logging & Monitoring
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="Application.html">
            
                <a href="Application.html">
            
                    
                    Section 5: Application LIfecycle Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="Cluster.html">
            
                <a href="Cluster.html">
            
                    
                    Section 6: Cluster Maintenance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="Security.html">
            
                <a href="Security.html">
            
                    
                    Section 7: Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="Storage.html">
            
                <a href="Storage.html">
            
                    
                    Section 8: Storage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="Networking.html">
            
                <a href="Networking.html">
            
                    
                    Section 9: Networking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="Install.html">
            
                <a href="Install.html">
            
                    
                    Section 10: Design and Install a Kubernetes Cluster
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.10" data-path="Kubeadm.html">
            
                <a href="Kubeadm.html">
            
                    
                    Section 11: Install "Kubernetes the kubeadm way"
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="Troubleshooting.md">
            
                <span>
            
                    
                    Section 12: Troubleshooting
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Section 11: Install "Kubernetes the kubeadm way"</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="install-kubernetes-the-kubeadm-way">Install Kubernetes the kubeadm way</h1>
<h2 id="introduction-to-deployment-with-kubeadm">Introduction to deployment with kubeadm</h2>
<h3 id="steps">Steps</h3>
<ol>
<li>Have multiple systems or vm provisioned for configuring a cluster.
Once the systems are created, designate one node as master and other as worker nodes.</li>
<li>Install a container runtime on the hosts. We using Docker. Install docker on all the nodes.</li>
<li>Install kubeadm tool on all the nodes, the kubeadm tool helps us bootscrap the k8s solution by installing and confgiguring all the required
components in the right nodes in the right order.</li>
<li>Initialize the master server. During this process all the required components are installed and confgigured on the master server.
Once the master is initialized and before joining the worker nodes to the master, you must ensure that the network prerequisites are met and
normal network connectivity between the systems is not sufficient for this.
K8s requires a special networking solution between the master and worker nodes, which is called as the pod network.</li>
<li>join the worker node to the master node.<h2 id="deploy-with-kubeadm-provision-vm-with-vagrant">Deploy with kubeadm-Provision VM with Vagrant</h2>
<a href="https://github.com/kodekloudhub/certified-kubernetes-administrator-course.git" title="repo" target="_blank">repo</a>
vagrant ssh kubemaster<h2 id="demo-deployment-with-kubeadm">Demo-deployment with kubeadm</h2>
<a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/" target="_blank">install kubeadm</a><pre><code class="lang-bash">lsmod | grep br_netfilter
modprobe br_netfilter
</code></pre>
run on all the nodes<h3 id="letting-iptables-see-bridged-traffic">letting iptables see bridged traffic</h3>
<pre><code class="lang-bash">cat &lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
EOF
sudo sysctl --system
</code></pre>
</li>
</ol>
<h3 id="install-docker-engine-on-ubuntu">Install Docker Engine on ubuntu:</h3>
<pre><code class="lang-bash">apt-get install \
    ca-certificates \
    curl \
    gnupg \
    lsb-release
<span class="hljs-built_in">echo</span> \
  <span class="hljs-string">&quot;deb [arch=<span class="hljs-variable">$(dpkg --print-architecture)</span> signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \
  <span class="hljs-variable">$(lsb_release -cs)</span> stable&quot;</span> | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg
apt-get update
apt-get install docker-ce docker-ce-cli containerd.io
systemctl <span class="hljs-built_in">enable</span> docker.service
systemctl <span class="hljs-built_in">enable</span> containerd.service
systemctl edit docker.service
[Service]
ExecStart=
ExecStart=/usr/bin/dockerd -H fd:// -H tcp://127.0.0.1:2375
systemctl daemon-reload
systemctl restart docker.service
systemctl status docker.service
</code></pre>
<h3 id="installing-kubeadm-kubelet-and-kubectl">Installing kubeadm, kubelet and kubectl</h3>
<ul>
<li>kubeadm: the command to bootstrap the cluster.</li>
<li>kubelet: the component that runs on all of the machines in your cluster and does things like starting pods and containers.</li>
<li>kubectl: the command line util to talk to your cluster.</li>
</ul>
<p><code>kubeadm init --pod-network-cidr 10.244.0.0/16 --apiserver-advertise-address=192.168.56.2</code>
<code>kubeadm join 10.26.82.9:6443 --token 5oze05.sgcn4a5j8or1ho3m \
        --discovery-token-ca-cert-hash sha256:cd674108921cedba78804f3d5632503f098a53ecc36b4c1217bcd9cac8d308da</code>
Check kubeadm version: <code>kubeadm version -o short</code></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Install.html" class="navigation navigation-prev " aria-label="Previous page: Section 10: Design and Install a Kubernetes Cluster">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Troubleshooting.md" class="navigation navigation-next " aria-label="Next page: Section 12: Troubleshooting">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Section 11: Install \"Kubernetes the kubeadm way\"","level":"1.10","depth":1,"next":{"title":"Section 12: Troubleshooting","level":"1.11","depth":1,"path":"Troubleshooting.md","ref":"Troubleshooting.md","articles":[]},"previous":{"title":"Section 10: Design and Install a Kubernetes Cluster","level":"1.9","depth":1,"path":"Install.md","ref":"Install.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Kubeadm.md","mtime":"2022-03-03T12:30:57.961Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-03-05T11:53:35.199Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

